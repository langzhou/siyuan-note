var t=(t,e,i)=>new Promise(((s,n)=>{var o=t=>{try{r(i.next(t))}catch(e){n(e)}},l=t=>{try{r(i.throw(t))}catch(e){n(e)}},r=t=>t.done?s(t.value):Promise.resolve(t.value).then(o,l);r((i=i.apply(t,e)).next())}));import{f as e,r as i,o as s,c as n,a as o,w as l,b as r,e as a,H as h}from"../assets/vendor.92b6123c.js";/* empty css                      */const c={data:()=>({hi:"hello",form:{note:""}}),methods:{init(){return t(this,null,(function*(){chrome.storage.local.get(["setting"],(e=>t(this,null,(function*(){if(this.setting=!(!e.setting||"{}"==JSON.stringify(e.setting.user))&&e.setting.user,this.setting.appendUrlTitle){let t=yield this.appendUrlTitle();this.form.note+=t}this.setting.noteTags&&(this.form.note+=this.setting.noteTags+" "),this.input=document.querySelector("#input"),this.input.focus(),this.btn=document.querySelector(".save-btn"),this.baseUrl=this.setting.baseUrl?this.setting.baseUrl:"127.0.0.1:6806",this.setting.noteBox||this.showBtnNotice("请先设置笔记本 →","warning",5e3)}))))}))},appendUrlTitle(){return new Promise(((t,e)=>{chrome.tabs.query({active:!0,currentWindow:!0},(e=>{this.pageUrl=e[0].url,this.pageTitle=e[0].title,t(`来源：[${this.pageTitle}](${this.pageUrl})\n`)}))}))},saveNote(){if(!this.form.note)return this.btn.innerText="老哥，啥也没写呢",this.btn.classList.add("el-button--danger"),void setTimeout((()=>{this.btn.innerText="保存",this.btn.classList.remove("el-button--danger")}),2e3);if(!this.setting.noteBox)return void this.showBtnNotice("请先设置笔记本 →","warning");let t=e().format("YYYYMMDD HH:mm:ss")+".sy";switch(this.setting.noteTitleType){case"网页标题":this.noteTitle=this.pageTitle+".sy";break;case"首行内容":let e=this.form.note.split("\n");this.noteTitle=e[0]?e[0]+".sy":t;break;default:this.noteTitle=t}this.noteFolder=this.setting.noteFolder?"/"+this.setting.noteFolder+"/":"";let i=this.noteFolder+this.noteTitle.replace(/[\/|\\|\:|\*|\?|\"|\<|\>|\|]+/g,"-"),s={notebook:this.setting.noteBox,path:i,markdown:this.form.note.replace(/\n/g,"\n\n")},n="http://"+this.baseUrl+"/api/filetree/createDocWithMd";fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((t=>t.json())).then((t=>{0==t.code?(this.form.note="",this.showBtnNotice("保存成功")):this.showBtnNotice(t.msg,"danger")})).catch((t=>{console.log(t),this.showBtnNotice("网络错误","danger")}))},showBtnNotice(t,e="success",i=2e3){this.btn.innerText=t,this.btn.classList.add(`el-button--${e}`),setTimeout((()=>{this.btn.innerText="保存",this.btn.classList.remove(`el-button--${e}`)}),i)},openOptions(){window.open(chrome.runtime.getURL("libs_options.html"))}},mounted(){this.init()}},d={class:"main"},u={style:{display:"flex","justify-content":"space-between"}},m=r("保存");c.render=function(t,e,r,a,h,c){const p=i("el-input"),g=i("el-form-item"),f=i("el-form"),b=i("el-button");return s(),n("div",d,[o(f,{ref:"form",model:h.form,"label-width":"auto"},{default:l((()=>[o(g,{label:""},{default:l((()=>[o(p,{id:"input",type:"textarea",modelValue:h.form.note,"onUpdate:modelValue":e[1]||(e[1]=t=>h.form.note=t),placeholder:"写点啥不"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),o("div",u,[o(b,{class:"save-btn",type:"primary",size:"medium",round:"",plain:"",onClick:c.saveNote},{default:l((()=>[m])),_:1},8,["onClick"]),o(b,{title:"设置",icon:"el-icon-setting",circle:"",onClick:c.openOptions},null,8,["onClick"])])])},a(c).use(h).mount("#app");
